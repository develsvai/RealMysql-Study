## My ISAM 스토리지 엔진 아키텍쳐 

## 4.3.1 키캐시 


MySQL 매뉴얼에서는 키 캐시를 이용한 쿼리의 히트율을 99% 이상으로 유지하는 것을 권장.
그러나 32비트 운영체제에서는 하나의 키 캐시에 4GB 이상의 메모리 공간을 설정할 수 없으며, 
이를 해결하기 위해 64비트 운영체제에서는 별도의 명명된 키 캐시 공간을 설정할 수 있음

기본(Default) 키 캐시 이외에도 명명된 키 캐시 공간을 설정할 수 있음.
이를 설정하려면 해당 키 캐시의 크기와 이름을 명시해야 함.

기본 키 캐시 설정: key_buffer_size 파라미터를 사용하여 설정

```
key_buffer_size = 46B

```

추가 키 캐시 설정: 별도의 이름을 지정하여 설정
```
kbuf_board.key_buffer_size = 2GB
kbuf_comment.key_buffer_size = 26B

```

기본(Default)이 아닌 명명된 추가 키 캐시는 메모리를 할당만 하고 사용하지 않는다는 점에 주의해야 함.
따라서 명명된 각 키 캐시에 어떤 인덱스를 캐시할지 MySQL(MyISAM 스토리지 엔진)에 알려줘야 함.
이를 설정하기 위해 다음과 같은 명령어를 사용

```
CACHE INDEX db1.board, db2.board IN kbuf_board;
CACHE INDEX db1.comment, db2.comment IN kbuf_comment;

```

이렇게 설정하면 각 테이블의 인덱스가 해당 명명된 키 캐시를 사용하여 캐시될 수 있음.
나머지 테이블의 인덱스는 기본 키 캐시를 사용하게 된다. 

## 4.3.2 운영체제의 캐시 및 버퍼 

MyISAM 테이블의 인덱스는 키 캐시를 통해 디스크를 검색하지 않고도 빠르게 검색할 수 있다. 
그러나 MyISAM 테이블의 데이터에 대해서는 디스크로부터의 I/O를 처리할 만한 버퍼링 기능이 없기 때문에 데이터 읽기나 쓰기 작업은 항상 운영체제의 디스크 작업으로 요청함. 
이는 MyISAM 테이블에 대한 쿼리 처리를 느리게 만들 수 있다.

운영체제의 캐시 기능은 InnoDB와 같이 데이터의 특성을 알지는 못하지만, 없는 것보다는 낫다. 
운영체제의 캐시 공간은 남는 메모리를 사용하므로, 전체 메모리가 다른 애플리케이션에 의해 모두 사용되면 
운영체제가 캐시 용도로 사용할 공간이 없어지게 된다. 
이경우 MyISAM 테이블의 데이터를 캐시하지 못하고, 결과적으로 쿼리 처리가 느려질 수 있다.

일반적으로 MyISAM 테이블을 사용하는 MySQL에서는 키 캐시를 최대 물리 메모리의 40% 이상으로 설정하고, 
나머지 메모리 공간을 운영체제가 파일 시스템을 위해 사용할 수 있는 캐시 공간으로 남겨두는 것을 권장  
이렇게 하면 운영체제가 디스크 작업을 보다 효율적으로 처리할 수 있으며, 
MyISAM 테이블에 대한 쿼리 처리 속도를 향상시킬 수 있다.


