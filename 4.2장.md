# 4.2 InnoDB 스토리지 엔진 아키텍쳐 

<img width="596" alt="스크린샷 2024-02-17 오후 6 30 13" src="https://github.com/develsvai/RealMysql-Study/assets/125961256/26df51d5-290f-49fa-b686-32dc5baa2d71">

## 4.2.1 프라이머리 키에 의 한 클러스터링 
InnoDB 의 모든 테이블은 기본적으로 프라이머리 키를 기준으로 클러스터링 되어 저장된다. 즉 프라이머리 키값의 순서대로 디스크에 저장됨.

MyIsam은 클러스터링 키를 지원하지않음 !

## 4.2.2 외래키 지원 

왜래키에 대한 지원은 InnoDB 스토리지 엔진 레벨에서 지원하는 기능으로 Isam 이나 메모리 테이블에서는 사용할수 없다. 외래키는 데이터 베이스 서버운영의 불편함 떄문에 서비스용 데이터 베이스에서는 생성하지 않은 경우도 자주있다.

외래키는 부모 테이블과 자식 테이블 모두 해당 칼럼에 인덱스 생성이 필요하고 변경시에는 반드시 부모 테이블 이나 자식 테이블에 데이터 가 있는지 체크하는 작업이 필요하여 잠금이 여러 테이블로 전파되고 그로 인해 데드락 이 발생할수 있어 주의 해야한다. 


## 4.2.3 MVCC 

일반적 으로 레코드 레벨의 트랜젝션 을 지원하는 DBMS가 제공하는 기능 이며 , 가장큰 목적은 잠금을 사용하지 않는 일관된 읽기 를 제공하는데 있다. InnoDBsms 언두 로그 를 이용해 이 기능을 구현한다. 

여기서 MV(멀티 비전) 이라 함은 하나의 레코드에 대해 여러개의 버전이 동시에 관리 된다는 의미이다.

뭔 말인지 이해 불가.. 일단 패스 


## ~ 4.2.5. 까지 일단 패스 

## 4.2.6 자동화 된 장애 복구 
InnoDB 에는 손실이나 장애로부터 데이터를 보호 하기 위한 여러 가지 매커니즘이 탑재 되있다. 그러한 메커니즘을 이용해 MySql 서버가 시작될떄 완료되지 못한 트랜잭션 이나 디스크에 일부 만 기록된 데이터 페이지들에 대한 일련의 복구 작업이 자동으로 진행된다. 

InnoDB 스토리지 엔진 은 매우 견고 해서 데이터 파일이 손상되거나 서버가 시작되지 못하는 경우는 드믈다 .
하지만 하드웨어 이슈로 인해 SQL 서버와 무관하게 스토리지 엔진 이 복구를 못하는 경우도 발생한다. 

자세한 설정방법은 책 을 참고 

## 4.2.7 InnoDB 버퍼 폴 

InnoDB의 가장 핵심적인 부분으로 디스크의 데이터 파일 이나 인텍스 정보를 메모리에 캐시해 두는 공간이다. 쓰기 작업을 지연시켜 일괄 작업 으로 처리 할수 있게 해주는 버퍼 역활도 같이 한다. 일반적인 애플리케이션 에서는 INSERT, UPDATE, DELETE처럼 데이터를 변경하는 쿼리 는 데이터 파일의 이곳저곳 위치한 리코드를 변경하기 떄문에 랜덤한 디스크 작업을 발생 시킨다. 하지만 버퍼 폴이 이러한 변경된 데이터 를 모아서 처리하면 랜덤한 디스크 작업의 횟수 를 줄일 수 있다. 

### 4.2.7.1 버퍼 폴의 크기 설정 


